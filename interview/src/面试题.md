### 单核cpu下是否有线程安全问题？
先说答案：会有（非原子操作）
影响线程安全的三大问题：可见性，原子性，有序性
如果非原子操作，必然是有线程安全问题。
但不存在可见性问题，因为只有一份共享内存。
### mysql 什么情况下会产生死锁？
- 两个或两个以上的事务
- 每个事务都已经持有锁并且申请新的锁
- 锁资源同时只能被同一个事务持有或者不兼容
- 事务之间因为持有锁和申请锁导致彼此循环等待
### mysql如何避免死锁？
- 合理的设计索引，区分度高的放到组合索引前面，尽可能的通过索引定位很少的行，减少锁竞争
- 调整业务逻辑SQL执行顺序，避免update/delete长时间持有锁的SQL在事务前面
- 避免大事务，尽量将大事务拆成多个小事务执行
- 以固定的顺序访问表和行。比如两个更新数据的事务，事务 A 更新数据的顺序为 1，2;事务 B 更新数据的顺序为 2，1。这样更可能会造成死锁。
### Zuul和Gateway的区别
 Zuul：
 - 使用的是阻塞式api，不支持长连接，比如websocket
 - 底层是servlet，Zuul处理的是http请求
 - 没有提供异步支持，流控等均由hystrix支持。
 Gateway：
 - Spring Boot和Spring Webflux提供的Netty底层环境，不能和传统的Servlet容器一起使用，也不能打包成一个WAR包。
 - 提供了异步支持，提供了抽象负载均衡，提供了抽象流控，并默认实现了RedisRateLimiter。
 相同点：
 - 底层都是servlet
 - 两者均是web网关，处理的是http请求
 不同点：
 - 内部实现：
   - gateway对比zuul多依赖了spring-webflux，在spring的支持下，功能更强大，内部实现了限流、负载均衡等，扩展性也更强，但同时也限制了仅适合于Spring Cloud套件
   - zuul则可以扩展至其他微服务框架中，其内部没有实现限流、负载均衡等。
 - 是否支持异步：
   - zuul仅支持同步
   - gateway支持异步。理论上gateway则更适合于提高系统吞吐量（但不一定能有更好的性能），最终性能还需要通过严密的压测来决定
 - 框架设计的角度
   - gateway具有更好的扩展性，并且其已经发布了2.0.0的RELESE版本，稳定性也是非常好的
 - 性能：
   - WebFlux 模块的名称是 spring-webflux，名称中的 Flux 来源于 Reactor 中的类 Flux。Spring webflux 有一个全新的非堵塞的函数式 Reactive Web 框架，
   可以用来构建异步的、非堵塞的、事件驱动的服务，在伸缩性方面表现非常好。使用非阻塞API。 Websockets得到支持，并且由于它与Spring紧密集成，所以将会是一个更好的开发体验。
   - Zuul 1.x，是一个基于阻塞io的API Gateway。Zuul已经发布了Zuul 2.x，基于Netty，也是非阻塞的，支持长连接，但Spring Cloud暂时还没有整合计划。

### 高并发请求处理方案？
核心思想：分而治之-请求分流
- 提高应用处理的性能：前端静态化、CDN、多级缓存、分库分表、SQL优化等
- 集群处理
- 异步+集群